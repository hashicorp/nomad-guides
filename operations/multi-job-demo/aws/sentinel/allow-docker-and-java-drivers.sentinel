# Only allow Docker and Java drivers

# Copyright (c) HashiCorp, Inc.
# SPDX-License-Identifier: MPL-2.0

# Allow Docker rule
allow_docker_and_java = rule {
  all job.task_groups as tg {
    all tg.tasks as task {
      task.driver in ["docker", "java"]
    }
  }
}

# Main rule
main = rule {
  allow_docker_and_java
}
